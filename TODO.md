# Rift Rail Development Roadmap (开发路线图)

## 📅 Phase 1: 稳定与清理 (v0.8.x - The Great Clean-up)
**目标**：彻底完成 Cybersyn 兼容层的重构，移除技术债，发布一个干净、稳定的版本。

### Cybersyn 兼容性重构
- [✅] 移除 `cybersyn_scheduler.lua` (非 SE 暴力兼容)
- [✅] 实装 $N \times M$ 伪装池化逻辑 (在 SE 环境下)
- [✅] 实装迁移脚本：清理旧版脏数据，自动重建连接
- [x] 添加"出口"GUI 的代理开关功能

### 用户引导更新
- [✅] 更新 Mod Portal 描述 (移除无 SE 支持的声明)
- [✅] 添加游戏内迁移提示消息 (Migration Message)
- [✅] 发布 FAQ 文档

### 代码大扫除
- [✅] 移除代码中所有废弃的注释和调试用的 `log`
- [✅] 统一文件头部注释的版本号

---

## 📅 Phase 2: 靶向系统重构 (v0.9.x - The Targeting Update)
**目标**：从"1v1 配对"进化为"多对一 (N->1) 靶向"，真正发挥非对称建筑的优势。

### 核心数据结构变更
- [ ] 废弃 `paired_to_id` (单一配对)
- [ ] 引入 `target_id` (入口指向的出口) 和 `source_ids` (出口记录的来源列表)
- [ ] 编写迁移脚本：将现有的配对数据转换为新的靶向数据

### GUI 交互重写
- [ ] 移除"配对 (Link)"按钮
- [ ] 新增 **"选择目标 (Select Target)"** 界面：列出所有可用的出口，允许玩家选择一个
- [ ] (可选) 在地图上高亮显示所选的出口

### 逻辑适配
- [ ] 更新 LTN 和 Cybersyn 的注册逻辑：适配新的靶向数据结构
- [ ] 实现 **多入口 -> 单出口** 的支持：允许多个不同位置的入口指向同一个出口

### 游戏性平衡 (可选)
- [ ] **科技树集成**：研究科技解锁更多的连接数量上限（如果未来做多对多）
- [ ] **能耗调整**：基于传送距离计算能耗（如果想增加硬核度）

---

## 📅 Phase 3: 智能路由与多向传送 (v1.0 - The Smart Routing)
**目标**：探索"单入口 -> 多出口 (1->N)"的可能性，让 Rift Rail 成为真正的铁路网络。

### 意图推断算法 (Intent Inference)
- [ ] 研究如何读取列车时刻表，判断列车的下一站属于哪个地表
- [ ] 实现：当列车撞击入口时，动态决定传送到哪一个出口

### 多目标 GUI
- [ ] 允许一个入口选择**多个**潜在的出口
- [ ] 在 GUI 中管理出口列表（添加/删除/优先级）

### 高级可视化
- [ ] 绘制传送门之间的连接线（利用 Factorio 的连线渲染 API）
- [ ] 在小地图上显示传送网络拓扑

---

## 🛠️ 持续维护 (Ongoing)
- [ ] **本地化 (Localization)**：保持中英文翻译的同步更新
- [ ] **Bug 修复**：响应社区反馈（如 SE 更新导致的破坏）
- [ ] **性能监控**：持续关注 `on_tick` 和传送逻辑的 UPS 消耗，确保在大规模使用下依然流畅

---

## 📊 进度总结

| 阶段 | 名称 | 状态 | 预计版本 |
|------|------|------|---------|
| Phase 1 | The Great Clean-up | ✅ **已完成** | v0.8.x |
| Phase 2 | The Targeting Update | ⏳ 未开始 | v0.9.x |
| Phase 3 | The Smart Routing | ⏳ 未开始 | v1.0 |

---

## 📝 说明
- ✅ 已完成的任务
- ⏳ 未开始的任务
- 💡 可选/待定的项目用括号标注
- 优先级可根据社区反馈和时间安排调整
